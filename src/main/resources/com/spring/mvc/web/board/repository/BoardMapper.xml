<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!-- namespace 에는 사용할 인터페이스의 풀 경로(패키지명 포함 인터페이스)를 적는다-->
<mapper namespace="com.spring.mvc.web.board.repository.BoardMapper">
    <!--   글 저장 기능-->
    <!--    id 속성에는 매퍼 인터페이스의 메서드명을 적음-->
    <insert id="save">
        INSERT INTO board
        (board_no, writer, title, content)
        VALUES
        (seq_board.nextval, #{writer}, #{title}, #{content})
    </insert>

    <!--    글 삭제 기능-->
    <delete id="remove">
        DELETE FROM board
        WHERE board_no = #{boardNo}
    </delete>

    <!--    SELECT 문 처리를 위한 자비 필드와 테이블 컬럼명 매핑-->
    <!--    resultMap: 자바의 이름규칙과 SQL 의 이름규칙이 다를 때 매핑 처리-->
    <!--    id 속성에는 이 맵의 이름을 만들어주고 type 속성에는 해당 클래스 전체 경로-->
    <resultMap id="boardMap" type="com.spring.mvc.web.board.domain.Board">
        <!--        property 속성에는 자바 필드명, column 은 테이블 칼럼명-->
        <result property="boardNo" column="board_no"/>
        <result property="view" column="view_cnt"/>
    </resultMap>

    <!--    전체 조회 기능-->
    <select id="findAll" resultMap="boardMap">
        SELECT * FROM board
        ORDER BY board_no DESC
    </select>

    <!--    하나만 찾기-->
    <select id="findOne" resultMap="boardMap">
        SELECT * FROM board
        WHERE board_no = #{boardNo}
    </select>

    <!--    조회수 증가-->
    <update id="addview">
        UPDATE board SET view_cnt =
        <!--        (SELECT view_cnt FROM board-->
        <!--        WHERE board_no = #{boardNo}) +1-->
        view_cnt+1
        WHERE board_no = #{boardNo}
    </update>
    <!--    조회수 감소-->
    <update id="minusview">
        UPDATE board
        SET view_cnt = view_cnt - 1
        WHERE board_no = #{boardNo}
    </update>

    <!--    글 수정-->
    <update id="modify">
        UPDATE board
        SET title = #{title} , content = #{content}, writer = #{writer}
        WHERE board_no = #{boardNo}
    </update>
    <!--    추천하기-->
    <update id="recommendation">
        UPDATE board
        SET recommendation = recommendation + 1
        WHERE board_no = #{boardNo}
    </update>


</mapper>